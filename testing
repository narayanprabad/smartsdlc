Fix Option A (Fastest): Relax cookie characters (Spring Boot)

Add this to application.properties (or your cloud config):

server.tomcat.relaxed-cookie-chars=|,{,},[,],\,^,`,",<,>,;
server.tomcat.relaxed-path-chars=|,{,},[,],\,^,`,",<,>,;

Start with this minimal set if you want safer:

server.tomcat.relaxed-cookie-chars=[,],|,{},\

Then redeploy and check logs: the “invalid cookie” warnings should disappear.

Fix Option B (Tomcat-side): Legacy cookie processor

If you can edit Tomcat config in that cloud image:

In context.xml (global or app context):

<Context>
  <CookieProcessor className="org.apache.tomcat.util.http.LegacyCookieProcessor"/>
</Context>

Restart Tomcat.

This makes Tomcat more forgiving and is often the standard fix for older SSO cookies.

Fix Option C: Fix it at the source (IAM / SiteMinder team)

Best long-term: ask IAM to ensure the cookie conforms to RFC6265:

Avoid special characters in cookie value (or properly encode)

Ensure correct SameSite / Secure flags

But in enterprise reality, A or B is what people do.

What you should do (external Tomcat fix)
Option 1 (best): LegacyCookieProcessor via context.xml

You already did this. The only remaining question is: did Tomcat actually pick up that context.xml?

For external Tomcat, this must be in one of these places:

✅ A) Inside your WAR (recommended)

src/main/webapp/META-INF/context.xml

and after build, the WAR must contain:

META-INF/context.xml

✅ B) In Tomcat config

$CATALINA_BASE/conf/context.xml (global)

or

$CATALINA_BASE/conf/Catalina/<host>/<appname>.xml (per app)

If you placed it somewhere like build/tomcat/context.xml, Tomcat will ignore it unless your deployment explicitly copies it.
